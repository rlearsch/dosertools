
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>dostools.image_processing package &#8212; dostools 2022 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dostools-image-processing-package">
<h1>dostools.image_processing package<a class="headerlink" href="#dostools-image-processing-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-dostools.image_processing.binary">
<span id="dostools-image-processing-binary-module"></span><h2>dostools.image_processing.binary module<a class="headerlink" href="#module-dostools.image_processing.binary" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.binary.add_saved_params_to_dict">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.binary.</span></span><span class="sig-name descname"><span class="pre">add_saved_params_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/binary.html#add_saved_params_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.binary.add_saved_params_to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds parameters saved with binaries from tiffs to parameters from file name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_location</strong> (<em>path-like</em>) – folder where file containing parameters was saved</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – existing parameters dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>add_saved_params_to_dict</strong> – dictionary containing parameters from csv and from existing dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.binary.binaries_to_diameter_time">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.binary.</span></span><span class="sig-name descname"><span class="pre">binaries_to_diameter_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binary_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/binary.html#binaries_to_diameter_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.binary.binaries_to_diameter_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts binary image series into normalized diameter vs. time data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binary_location</strong> (<em>path-like</em>) – folder where binary images are located</p></li>
<li><p><strong>window</strong> (<em>np.array</em>) – array of the boundaries of the image to analyze in the format
[left, top, right, bottom]</p></li>
<li><p><strong>params_dict</strong> – dictionary of parameters from file name and metadate saved with
binary images
requires parameters nozzle_diameter and fps</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_to_diameter_time</strong> – dataframe of time and D/D0 from the binary images</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.binary.binary_images_to_csv">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.binary.</span></span><span class="sig-name descname"><span class="pre">binary_images_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/binary.html#binary_images_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.binary.binary_images_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from binary images to csv of normalized diameter versus time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_location</strong> (<em>path-like</em>) – The path to the folder that contains “bin” folder of binary images and
csv of parameter metadata, should be named with relevent experimental
information. Save location used in tiff_handling functions.
ex. folder of “20210929_6M-PEO-0p01wtpt_fps25k_1”</p></li>
<li><p><strong>csv_location</strong> (<em>path-like</em>) – The path to the folder in which csv should be saved.</p></li>
<li><p><strong>fps</strong> (<em>float</em>) – Frames per second for the video (likely parsed from file name)</p></li>
<li><p><strong>optional_settings</strong> (<em>dict</em>) – <p>A dictionary of optional settings.
Used in this function:</p>
<blockquote>
<div><p>skip_existing, default True; False to overwrite existing csv</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None. Saves file to disk.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.binary.bottom_border">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.binary.</span></span><span class="sig-name descname"><span class="pre">bottom_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/binary.html#bottom_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.binary.bottom_border" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds bottom border of supplied image</p>
<p>Finds bottom border of supplied image for analysis by finding the row with
the maximum number of white pixels below the half the height of the image
(the bottom half). Return the index of the row with the first maximum number
of white pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.ndarray</em><em> (</em><em>scikit.io.imread</em><em>)</em>) – Image from scikit.io.imread import to find the bottom border of the
section to analyze</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bottom_border</strong> – Index of last row to include in analysis, chosen as row with the most
white pixels in the binary below the bottom half of the image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.binary.calculate_min_diameter">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.binary.</span></span><span class="sig-name descname"><span class="pre">calculate_min_diameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/binary.html#calculate_min_diameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.binary.calculate_min_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the minimum diameter of the liquid bridge for a given image</p>
<p>Finds the minimum diameter in the window for a given image.
Calculates a diameter profile that is the number of pixels from the first
white pixel to the last white pixel. Returns 0 if there are any rows that
are fully black within the window (bottom is calculated on a per-image
basis using bottom_border). Returns the average of any values that are
within 2 pixels of the minimum measured diameter if there are no fully
black rows. Averaging attempting to reduce stepping due to the finite size
of pixels relative to the thin liquid bridge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em> (</em><em>scikit.io.imread</em><em>)</em>) – image of which to find the minimum diameter of the liquid bridge</p></li>
<li><p><strong>window</strong> (<em>np.array</em>) – array of the boundaries of the image to analyze in the format
[left, top, right, bottom]
bottom will be replaced with the result of bottom_border(image)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>min_diameter</strong> – minimum diameter measured for the image in the window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dostools.image_processing.tiff_handling">
<span id="dostools-image-processing-tiff-handling-module"></span><h2>dostools.image_processing.tiff_handling module<a class="headerlink" href="#module-dostools.image_processing.tiff_handling" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.convert_tiff_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">convert_tiff_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folders_exist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#convert_tiff_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.convert_tiff_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully converts a raw tiff to binary png image.</p>
<p>Crops, perforns background subtraction, and binarizies. Always saves the png, optional to save the intermediate steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – The image to convert and save</p></li>
<li><p><strong>bg_median</strong> (<em>np.ndarray</em>) – The single background image produced from produce_background_image</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – Dictionary of parameters with the crop information added</p></li>
<li><p><strong>images_location</strong> (<em>path-like</em>) – The folder where file should be saved</p></li>
<li><p><strong>folders_exist</strong> (<em>Tuple of three bools</em>) – Booleans indicating whether the binary, crop, and bg_sub folders
already existed to allow convert_tiff_image image to skip the relevant
saves if optional_settings has skip_existing = True</p></li>
<li><p><strong>optional_settings</strong> (<em>dict</em>) – <p>A dictionary of optional settings.
Used in this function:</p>
<blockquote>
<div><p>save_crop, default False; True to save the intermediate cropped image
save_bg_sub, default False; True to save the background-subtracted image
skip_existing, default True; False to overwrite existing images</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Image sequence (video) saved on the hard drive at save_location</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.convert_tiff_sequence_to_binary">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">convert_tiff_sequence_to_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experimental_video</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">skimage.io.collection.ImageCollection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folders_exist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#convert_tiff_sequence_to_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.convert_tiff_sequence_to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes as arguments the skimage image sequence holding the experimental video and the background image to subtract.</p>
<p>Performs, sequentially, cropping, background subtraction, and binarization by the Mean method, and saves the binary images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experimental_video</strong> (<em>skimage.io.collection.ImageCollection</em>) – The video identified as the experiment video from the researcher</p></li>
<li><p><strong>bg_median</strong> (<em>np.ndarray</em>) – The single background image produced from produce_background_image</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – Dictionary of parameters with the crop information added</p></li>
<li><p><strong>save_location</strong> (<em>path-like</em>) – The folder where file should be saved</p></li>
<li><p><strong>folders_exist</strong> (<em>Tuple of three bools</em>) – Booleans indicating whether the binary, crop, and bg_sub folders
already existed to allow convert_tiff_image image to skip the relevant
saves if optional_settings has skip_existing = True</p></li>
<li><p><strong>optional_settings</strong> (<em>dict</em>) – <p>A dictionary of optional settings.
Used in this function:</p>
<blockquote>
<div><p>save_crop, default False; True to save the intermediate cropped image
save_bg_sub, default False; True to save the background-subtracted image</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Image(s) saved locally in save_location</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.crop_single_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">crop_single_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#crop_single_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.crop_single_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a single image according to parameters from params_dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em> (</em><em>scikit.io.imread</em><em>)</em>) – The video identified as the experiment video from the researcher</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – Dictionary of parameters with the crop information added</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cropped_image</strong> – The input image, cropped according to values in parameters dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.define_image_parameters">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">define_image_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">skimage.io.collection.ImageCollection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#define_image_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.define_image_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>From the given video, determines the first-guess for the cropping operation.</p>
<p>Based on the nozzle width and safety factors crop_width_coefficient, crop_height_coefficient, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video</strong> (<em>skimage.io.collection.ImageCollection</em>) – The video containing a clear image of the nozzle, we default to the raw experimental video</p></li>
<li><p><strong>optional_settings</strong> (<em>dict</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>params_dict</strong> – Dictionary of parameters with the crop information added</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.export_params">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">export_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#export_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.export_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports image parameters to a file to be stored with processed images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images_location</strong> (<em>path-like</em>) – Path in which to save the parameters.</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – Dictonary of parameters to save.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.mean_binarize_single_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">mean_binarize_single_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background_subtracted_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#mean_binarize_single_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.mean_binarize_single_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs global binarization on an image according to the Otsu method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>background_subtracted_image</strong> (<em>np.ndarray</em>) – The cropped image with the background subtraction performed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_otsu</strong> – The binarized version of the input image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.produce_background_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">produce_background_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background_video</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">skimage.io.collection.ImageCollection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#produce_background_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.produce_background_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces the background image from which the experimental video will be subtracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background_video</strong> (<em>skimage.io.collection.ImageCollection</em>) – The video identified as the background video from the researcher</p></li>
<li><p><strong>params_dict</strong> (<em>dict</em>) – Dictionary of parameters with the crop information added</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bg_median</strong> – The median of the frames in the background.
We prefer median because it is less sensitive to random noise and the values are likely to be integers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.save_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#save_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.save_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a single image to the hard drive in save_location</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – The image to save</p></li>
<li><p><strong>image_number</strong> (<em>int</em>) – Part of the filename. The frame number of this particular image in the video</p></li>
<li><p><strong>save_location</strong> (<em>path-like</em>) – The folder where file should be saved</p></li>
<li><p><strong>extension</strong> (<em>str</em>) – The file extension, eg, .tiff, .png</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Image saved on the hard drive at save_location</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.subtract_background_single_image">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">subtract_background_single_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cropped_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#subtract_background_single_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.subtract_background_single_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs background subtraction from a cropped image.</p>
<p>Assumes cropped_image and bg_median are the same size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cropped_image</strong> (<em>np.ndarray</em>) – The initial image, cropped according to values in parameters dictionary</p></li>
<li><p><strong>bg_median</strong> (<em>np.ndarray</em>) – The single background image produced from produce_background_image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>background_subtracted_image</strong> – The cropped image with the background subtraction performed</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.tiffs_to_binary">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">tiffs_to_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experimental_video_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_video_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#tiffs_to_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.tiffs_to_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Overall video processing pipeline: takes experimental video and background video, produces binarized video in target directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experimental_video_folder</strong> (<em>path-like</em>) – Points to the folder which contains the experimental video to analyse.</p></li>
<li><p><strong>background_video_folder</strong> (<em>path-like</em>) – Points to the folder which contains the background video used in analysis.</p></li>
<li><p><strong>images_location</strong> (<em>path-like</em>) – The folder where folders of images should be saved.</p></li>
<li><p><strong>optional_settings</strong> (<em>dict</em>) – <p>A dictionary of optional settings.
Used in this function:</p>
<blockquote>
<div><dl class="simple">
<dt>skip_existing: bool</dt><dd><p>Determines the behavior when a file already appears exists
when a function would generate it. True to skip any existing files.
False to overwrite (or delete and then write, where overwriting would
generate an error).
Default is True.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Determines whether processing functions print statements as they
progress through major steps. True to see print statements, False to
hide non-errors/warnings.
Default is False.</p>
</dd>
<dt>image_extension: string</dt><dd><p>The extension for images in the video folder. TIFF recommended.
Default is “tif”. Do not include “.”.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Used in nested functions:</dt><dd><dl class="simple">
<dt>save_crop: bool</dt><dd><p>True to save intermediate cropped images (i.e. experimental video
images cropped but not background-subtracted or binarized).
Default is False.</p>
</dd>
<dt>save_bg_sub: bool</dt><dd><p>True to save background-subtracted images (i.e. experimental video
images cropped and background-subtracted but not binarized).
Default is False.</p>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Image sequence(s) (video) saved on the hard drive at images_location</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dostools.image_processing.tiff_handling.top_border">
<span class="sig-prename descclassname"><span class="pre">dostools.image_processing.tiff_handling.</span></span><span class="sig-name descname"><span class="pre">top_border</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bg_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/dostools/image_processing/tiff_handling.html#top_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dostools.image_processing.tiff_handling.top_border" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the top border of interest given a background image.</p>
<p>Finds the last row of the nozzle in the background image to use as the top
border in further image analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bg_median</strong> (<em>np.ndarray</em>) – Background image corresponding to a particular run.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>top_border</strong> – Last row of the nozzle.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dostools.image_processing">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dostools.image_processing" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">dostools</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/installation.html">Installation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Rob Learsch and Red Lhota.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/dostools.image_processing.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>